---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionTitle from '../components/SectionTitle.astro';
import Terminal from '../components/Terminal.astro';
import { getCollection } from 'astro:content';

const allWork = await getCollection('work');
const allWriting = await getCollection('writing');

const featuredProjects = allWork.filter(p => p.data.featured).slice(0, 2);
const featuredEssays = allWriting.slice(0, 3);
---

<BaseLayout fullWidth={true}>
  <!-- The Problem + Terminal (2-column) -->
  <section class="section-immersive pt-8 md:pt-12">
    <div class="section-immersive-content">
      <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-start">
        <!-- Left: Intro -->
        <div class="animate-in">
          <SectionTitle prefix="The" keyword="Problem" accentColor="warning" />
          <p class="text-[var(--color-text-muted)] text-lg leading-relaxed">
            [DRAFT: The core problem you've observed - 2-3 sentences, be concrete]
          </p>
        </div>
        <!-- Right: Terminal -->
        <div class="animate-in animate-delay-1">
          <Terminal title="terminal">
            <span class="text-[var(--color-text-muted)]">$ </span><span class="text-[var(--color-text)]">[command]</span>
            <br /><span class="text-[var(--color-error)]">[error message]</span>
            <br /><span class="text-[var(--color-text-muted)]">$ </span>
          </Terminal>
        </div>
      </div>
    </div>
  </section>

  <!-- The Approach -->
  <section class="section-immersive section-alt">
    <div class="section-immersive-content">
      <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-start">
        <div class="animate-in">
          <SectionTitle prefix="My" keyword="Approach" accentColor="primary" />
          <p class="text-[var(--color-text-muted)] text-lg leading-relaxed">
            [DRAFT: Your unique angle - what do you do differently?]
          </p>
        </div>
        <div class="animate-in animate-delay-1">
          <Terminal title="example.py">
            <span class="text-[var(--color-text-dim)]"># [DRAFT: Code example that illustrates your approach]</span>
            <br />
            <br /><span class="text-[var(--color-secondary)]">config</span> = {'{'}
            <br />    <span class="text-[var(--color-accent)]">"key"</span>: <span class="text-[var(--color-warning)]">"value"</span>
            <br />{'}'}
          </Terminal>
        </div>
      </div>
    </div>
  </section>

  <!-- Results -->
  <section class="section-immersive">
    <div class="section-immersive-content animate-in">
      <SectionTitle prefix="Selected" keyword="Results" accentColor="primary" />
      <div class="grid grid-cols-3 gap-4 md:gap-8 mt-6">
        <div>
          <p class="result-number">[XX%]</p>
          <p class="result-label">[metric]</p>
        </div>
        <div>
          <p class="result-number">[XX%]</p>
          <p class="result-label">[metric]</p>
        </div>
        <div>
          <p class="result-number">[Xâ†’Y]</p>
          <p class="result-label">[metric]</p>
        </div>
      </div>
      <a href="/projects" class="inline-block mt-8 text-sm text-[var(--color-accent)] hover:text-[var(--color-accent-hover)] font-mono transition-colors">
        See the projects &rarr;
      </a>
    </div>
  </section>

  <!-- Writing + CTA (2-column) -->
  <section class="section-immersive section-alt">
    <div class="section-immersive-content">
      <div class="grid md:grid-cols-2 gap-8 md:gap-12">
        <!-- Left: Writing -->
        {featuredEssays.length > 0 && (
          <div class="animate-in">
            <SectionTitle prefix="Latest" keyword="Writing" accentColor="secondary" />
            <div class="space-y-3">
              {featuredEssays.map((post) => (
                <a
                  href={`/thinking/${post.slug}`}
                  class="block text-[var(--color-text)] hover:text-[var(--color-accent)] hover:no-underline transition-colors font-mono"
                >
                  {post.data.title}
                </a>
              ))}
            </div>
            <a href="/thinking" class="inline-block mt-6 text-sm text-[var(--color-accent)] hover:text-[var(--color-accent-hover)] font-mono transition-colors">
              All essays &rarr;
            </a>
          </div>
        )}
        <!-- Right: CTA -->
        <div class="animate-in animate-delay-1">
          <SectionTitle prefix="Let's" keyword="Connect" accentColor="primary" />
          <p class="text-[var(--color-text-muted)] mb-6">
            [DRAFT: Who should reach out and why]
          </p>
          <a
            href="/contact"
            class="btn-primary inline-flex items-center px-6 py-3 rounded-lg hover:no-underline"
          >
            Start a conversation
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
