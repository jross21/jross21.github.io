---
import BaseLayout from '../layouts/BaseLayout.astro';
import TerminalPanel from '../components/TerminalPanel.astro';
import TerminalProjectCard from '../components/TerminalProjectCard.astro';
import TerminalPostCard from '../components/TerminalPostCard.astro';
import CommandButton from '../components/CommandButton.astro';
import HeroSystemDiagram from '../components/graphics/HeroSystemDiagram.astro';
import AnimatedStat from '../components/AnimatedStat.astro';
import LogoBar from '../components/LogoBar.astro';
import AvailabilityBadge from '../components/AvailabilityBadge.astro';
import { getCollection } from 'astro:content';

const allWork = await getCollection('work');
const allWriting = await getCollection('writing');

const featuredProjects = allWork.filter(p => p.data.featured).slice(0, 3);
const curatedWritingSlugs = [
  'ai-project-will-fail',
  'what-agentic-means',
  'distribution-bottleneck',
];
const writingBySlug = new Map(allWriting.map((post) => [post.slug, post]));
const featuredEssays = curatedWritingSlugs
  .map((slug) => writingBySlug.get(slug))
  .filter((post): post is typeof allWriting[number] => Boolean(post));
---

<BaseLayout
  fullWidth={true}
  title="Julian Ross"
  description="Revenue Operations leader with 10+ years across GTM, data infrastructure, and AI-native automation."
>
  <!-- 1. Hero -->
  <section class="section-immersive pt-12 md:pt-20">
    <div class="section-immersive-content">
      <div class="animate-in max-w-3xl">
        <div class="mb-4">
          <AvailabilityBadge />
        </div>
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-[var(--color-text)] mb-6 leading-tight">
          Revenue Operations &amp; GTM Systems
        </h1>

        <div class="text-lg md:text-xl text-[var(--color-text-muted)] leading-relaxed max-w-2xl mb-8">
          10+ years building the data infrastructure, automation, and AI workflows that make revenue teams predictable.
        </div>

        <div class="flex flex-wrap gap-3">
          <CommandButton
            href="/julian-ross-resume.pdf"
            command="View resume"
            size="lg"
            primary={true}
            section="about"
          />
          <CommandButton
            href="https://www.linkedin.com/in/julianross21/"
            command="LinkedIn"
            size="lg"
            section="contact"
          />
        </div>
      </div>

      <!-- System Diagram -->
      <div class="mt-12 md:mt-16 animate-in animate-delay-2">
        <HeroSystemDiagram />
      </div>
    </div>
  </section>

  <!-- 2. Results + Stats -->
  <section class="section-immersive section-alt">
    <div class="section-immersive-content animate-in">
      <h2 class="text-2xl md:text-3xl font-bold text-[var(--color-text)] mb-8">
        Impact
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-12">
        <AnimatedStat
          value="8"
          prefix="$"
          suffix="M+"
          label="Qualified pipeline led"
        />
        <AnimatedStat
          value="40"
          prefix="~"
          suffix="%"
          label="Pipeline growth"
        />
        <AnimatedStat
          value="350"
          prefix="$"
          suffix="K/mo"
          label="Pipeline produced"
        />
      </div>
    </div>
  </section>

  <!-- 3. Featured Projects -->
  {featuredProjects.length > 0 && (
    <section class="section-immersive">
      <div class="section-immersive-content animate-in">
        <h2 class="text-2xl md:text-3xl font-bold text-[var(--color-text)] mb-8">
          Featured <span class="text-[var(--color-section-projects)]">Projects</span>
        </h2>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 pl-4 md:pl-6 border-l border-[var(--color-border)]">
          {featuredProjects.map((project) => (
            <TerminalProjectCard
              title={project.data.title}
              description={project.data.description}
              slug={project.slug}
              date={project.data.date}
            />
          ))}
        </div>

        <div class="mt-8">
          <CommandButton href="/projects" command="View all projects" section="projects" />
        </div>
      </div>
    </section>
  )}

  <!-- 4. Core Skills & Tools -->
  <section class="section-immersive section-alt">
    <div class="section-immersive-content animate-in">
      <h2 class="text-2xl md:text-3xl font-bold text-[var(--color-text)] mb-8">
        Skills &amp; Tools
      </h2>

      <div class="grid md:grid-cols-3 gap-6">
        <div class="terminal-panel">
          <div class="terminal-panel__body">
            <p class="text-[var(--color-text)] font-semibold text-sm mb-3">CRM &amp; Sales Ops</p>
            <div class="flex flex-wrap gap-2">
              {['Salesforce', 'HubSpot', 'Outreach', 'Salesloft', 'Gong', 'Clari'].map(tool => (
                <span class="tool-chip">{tool}</span>
              ))}
            </div>
          </div>
        </div>

        <div class="terminal-panel">
          <div class="terminal-panel__body">
            <p class="text-[var(--color-text)] font-semibold text-sm mb-3">Data &amp; Analytics</p>
            <div class="flex flex-wrap gap-2">
              {['Snowflake', 'dbt', 'Looker', 'Tableau', 'Power BI', 'Fivetran'].map(tool => (
                <span class="tool-chip">{tool}</span>
              ))}
            </div>
          </div>
        </div>

        <div class="terminal-panel">
          <div class="terminal-panel__body">
            <p class="text-[var(--color-text)] font-semibold text-sm mb-3">Automation &amp; AI</p>
            <div class="flex flex-wrap gap-2">
              {['Python', 'SQL', 'Zapier', 'Workato', 'Census', 'Claude / GPT'].map(tool => (
                <span class="tool-chip">{tool}</span>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 5. Selected Writing -->
  {featuredEssays.length > 0 && (
    <section class="section-immersive">
      <div class="section-immersive-content animate-in">
        <h2 class="text-2xl md:text-3xl font-bold text-[var(--color-text)] mb-6">
          Selected <span class="text-[var(--color-section-writing)]">Writing</span>
        </h2>

        <div class="grid md:grid-cols-3 gap-4">
          {featuredEssays.map((post) => (
            <TerminalPostCard
              title={post.data.title}
              description={post.data.description}
              slug={post.slug}
              category={post.data.category}
            />
          ))}
        </div>

        <div class="mt-6">
          <CommandButton href="/ideas" command="View all writing" section="writing" />
        </div>
      </div>
    </section>
  )}

  <!-- 6. LogoBar + Final CTA -->
  <section class="section-immersive section-alt">
    <div class="section-immersive-content">
      <LogoBar />

      <div class="mt-12 text-center">
        <h2 class="text-2xl font-bold text-[var(--color-text)] mb-4">
          Let's <span class="text-[var(--color-section-contact)]">Connect</span>
        </h2>
        <p class="text-[var(--color-text-muted)] mb-6 max-w-lg mx-auto">
          Looking for someone who can own RevOps end-to-end â€” from CRM architecture to AI workflows to executive reporting.
        </p>
        <div class="flex flex-wrap gap-3 justify-center">
          <CommandButton
            href="/julian-ross-resume.pdf"
            command="View resume"
            primary={true}
            section="about"
          />
          <CommandButton
            href="mailto:jross21@gmail.com"
            command="Get in touch"
            section="contact"
          />
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
