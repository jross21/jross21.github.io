---
const pathname = Astro.url.pathname;

const navItems = [
  { href: '/', label: 'Home', section: null, icon: 'home' },
  { href: '/projects', label: 'Projects', section: 'projects' as const, icon: 'folder' },
  { href: '/ideas', label: 'Ideas', section: 'ideas' as const, icon: 'lightbulb' },
  { href: '/expertise', label: 'Expertise', section: 'services' as const, icon: 'wrench' },
  { href: '/about', label: 'About', section: 'about' as const, icon: 'user' },
  { href: '/contact', label: 'Contact', section: 'contact' as const, icon: 'mail' },
];

function isActive(href: string) {
  if (href === '/') return pathname === '/';
  return pathname.startsWith(href);
}

function getActiveColor(section: string | null): string {
  if (!section) return 'var(--color-accent)';
  return `var(--color-section-${section})`;
}
---

<nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-[var(--color-bg)]/95 backdrop-blur-md border-t border-[var(--color-border)] safe-area-pb">
  <div class="flex items-center justify-around">
    {navItems.map((item) => (
      <a
        href={item.href}
        class:list={[
          'mobile-nav-item flex flex-col items-center gap-0.5 py-2 px-3 transition-colors hover:no-underline',
          isActive(item.href) && 'mobile-nav-item--active',
          item.section && `mobile-nav-item--${item.section}`
        ]}
        data-section={item.section}
        style={isActive(item.href) ? `color: ${getActiveColor(item.section)}` : undefined}
      >
        <svg class="mobile-nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          {item.icon === 'home' && (
            <>
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9 22 9 12 15 12 15 22"/>
            </>
          )}
          {item.icon === 'folder' && (
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
          )}
          {item.icon === 'lightbulb' && (
            <>
              <path d="M9 18h6"/>
              <path d="M10 22h4"/>
              <path d="M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"/>
            </>
          )}
          {item.icon === 'wrench' && (
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
          )}
          {item.icon === 'user' && (
            <>
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </>
          )}
          {item.icon === 'mail' && (
            <>
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </>
          )}
        </svg>
        <span class="text-[0.625rem] font-medium leading-none">
          {item.label}
        </span>
      </a>
    ))}
  </div>
</nav>

<style>
  .safe-area-pb {
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .mobile-nav-item {
    color: var(--color-text-muted);
  }

  .mobile-nav-item--active {
    color: var(--color-accent);
  }

  .mobile-nav-icon {
    flex-shrink: 0;
  }

  /* Section-specific hover colors */
  .mobile-nav-item--projects:hover {
    color: var(--color-section-projects);
  }

  .mobile-nav-item--ideas:hover {
    color: var(--color-section-writing);
  }

  .mobile-nav-item--about:hover {
    color: var(--color-section-about);
  }

  .mobile-nav-item--contact:hover {
    color: var(--color-section-contact);
  }

  .mobile-nav-item--services:hover {
    color: var(--color-section-services);
  }
</style>
