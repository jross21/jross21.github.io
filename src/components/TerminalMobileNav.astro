---
const pathname = Astro.url.pathname;

const navItems = [
  { href: '/', label: 'Home', section: null },
  { href: '/projects', label: 'Projects', section: 'projects' as const },
  { href: '/thinking', label: 'Writing', section: 'writing' as const },
  { href: '/about', label: 'About', section: 'about' as const },
  { href: '/contact', label: 'Contact', section: 'contact' as const },
];

function isActive(href: string) {
  if (href === '/') return pathname === '/';
  return pathname.startsWith(href);
}

function getActiveColor(section: string | null): string {
  if (!section) return 'var(--color-accent)';
  return `var(--color-section-${section})`;
}
---

<nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-[var(--color-bg)]/95 backdrop-blur-md border-t border-[var(--color-border)] safe-area-pb">
  <div class="flex items-center justify-around">
    {navItems.map((item) => (
      <a
        href={item.href}
        class:list={[
          'mobile-nav-item flex flex-col items-center gap-0.5 py-3 px-4 transition-colors hover:no-underline',
          isActive(item.href) && 'mobile-nav-item--active',
          item.section && `mobile-nav-item--${item.section}`
        ]}
        data-section={item.section}
        style={isActive(item.href) ? `color: ${getActiveColor(item.section)}` : undefined}
      >
        <span class="text-sm font-medium">
          {item.label}
        </span>
      </a>
    ))}
  </div>
</nav>

<style>
  .safe-area-pb {
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .mobile-nav-item {
    color: var(--color-text-muted);
  }

  .mobile-nav-item--active {
    color: var(--color-accent);
  }

  /* Section-specific hover colors */
  .mobile-nav-item--projects:hover {
    color: var(--color-section-projects);
  }

  .mobile-nav-item--writing:hover {
    color: var(--color-section-writing);
  }

  .mobile-nav-item--about:hover {
    color: var(--color-section-about);
  }

  .mobile-nav-item--contact:hover {
    color: var(--color-section-contact);
  }
</style>
